<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber-Scan Pro | Bhola 4 Record Finder</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>

    <style>
        @import url('https://fonts.cdnfonts.com/css/solaimanlipi');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --accent: #06b6d4;
            --bg-dark: #070b14;
            --card-bg: #111827;
            --glass: rgba(17, 24, 39, 0.8);
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #1f2937;
            --success: #10b981;
        }

        body {
            background: var(--bg-dark);
            background-image: 
                radial-gradient(at 0% 0%, rgba(37, 99, 235, 0.1) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(6, 182, 212, 0.1) 0px, transparent 50%);
            color: var(--text-main);
            font-family: 'Inter', 'SolaimanLipi', sans-serif;
            margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
        }

        .container { max-width: 800px; width: 92%; margin-top: 60px; padding-bottom: 100px; }

        header { text-align: center; margin-bottom: 40px; }
        header h1 { 
            font-size: 2.5rem; 
            background: linear-gradient(to right, #60a5fa, #22d3ee);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            letter-spacing: -1px;
        }
        header p { color: var(--text-muted); font-size: 1rem; opacity: 0.8; }

        .search-box {
            position: sticky; top: 20px;
            background: var(--glass);
            backdrop-filter: blur(16px);
            padding: 30px; border: 1px solid var(--border);
            border-radius: 24px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5);
            z-index: 100;
        }

        .status { 
            font-size: 0.8rem; 
            color: var(--accent); 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            margin-bottom: 10px; 
            font-weight: 600;
        }

        .progress { height: 4px; background: #1f2937; border-radius: 10px; overflow: hidden; margin-bottom: 20px; }
        .progress span { display: block; height: 100%; width: 0%; background: var(--primary); transition: width 0.4s ease; }

        .selector-group {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 12px; margin-bottom: 15px;
        }

        select, input {
            width: 100%; background: #030712;
            border: 1px solid var(--border); border-radius: 12px;
            color: white; font-size: 0.95rem; padding: 14px;
            outline: none; font-family: inherit;
            box-sizing: border-box; transition: all 0.2s;
        }

        select:focus, input:focus { border-color: var(--primary); ring: 2px var(--primary); }

        #searchBtn {
            width: 100%; padding: 14px; background: var(--primary);
            color: white; border: none; border-radius: 12px;
            font-weight: 600; cursor: pointer; margin-bottom: 12px;
            font-size: 1rem; transition: background 0.3s;
        }
        #searchBtn:hover { background: var(--primary-hover); }

        #downloadBtn {
            width: 100%; padding: 12px; background: transparent;
            color: var(--success); border: 1px solid var(--success); border-radius: 12px;
            font-weight: 600; cursor: pointer; display: none; margin-top: 10px;
        }
        #downloadBtn:hover { background: rgba(16, 185, 129, 0.1); }

        .result-card {
            background: var(--card-bg); margin-top: 16px; padding: 24px;
            border-radius: 18px; border: 1px solid var(--border);
            transition: transform 0.2s;
        }
        .result-card:hover { transform: translateY(-2px); border-color: #374151; }

        .data-content { font-size: 1.05rem; color: #e2e8f0; line-height: 1.8; }
        .label-text { color: var(--accent); font-weight: 600; margin-right: 6px; font-size: 0.9rem; }
        .highlight { background: rgba(37, 99, 235, 0.3); border-bottom: 2px solid var(--primary); color: #fff; }

        .count { text-align: center; margin-top: 40px; color: var(--text-muted); font-weight: 500; }

        /* Creator Footer */
        footer {
            margin-top: auto; width: 100%; padding: 40px 0;
            border-top: 1px solid var(--border); text-align: center;
            background: rgba(0,0,0,0.2);
        }
        .footer-content h3 { color: var(--text-main); font-size: 1.1rem; margin-bottom: 5px; }
        .footer-content p { color: var(--text-muted); font-size: 0.85rem; }
        .contact-links { margin-top: 15px; }
        .contact-links a { 
            color: var(--primary); text-decoration: none; 
            margin: 0 10px; font-weight: 600; font-size: 0.9rem;
        }
        .contact-links a:hover { text-decoration: underline; }

        .error-msg { color: #f87171; background: rgba(248, 113, 113, 0.1); padding: 15px; border-radius: 12px; margin-top: 15px; border: 1px solid rgba(248, 113, 113, 0.2); }
    </style>
</head>

<body>
<div class="container">
    <header>
        <h1>Bhai Bhai Phone Shefa Medical Center</h1>
        <p>ভোলা-৪ (চরফ্যাশন-মনপুরা) উন্নত ভোটার রেকর্ড অনুসন্ধান সিস্টেম</p>
    </header>

    <div class="search-box">
        <div id="status" class="status">Initializing System...</div>
        <div class="progress"><span id="bar"></span></div>
        
        <div class="selector-group">
            <select id="wardSelect">
                <option value="1">ওয়ার্ড নং-০১</option>
                <option value="2">ওয়ার্ড নং-০২</option>
                <option value="3">ওয়ার্ড নং-০৩</option>
                <option value="4">ওয়ার্ড নং-০৪</option>
                <option value="5">ওয়ার্ড নং-০৫</option>
                <option value="6">ওয়ার্ড নং-০৬</option>
                <option value="7">ওয়ার্ড নং-০৭</option>
                <option value="8" selected>ওয়ার্ড নং-০৮</option>
                <option value="9">ওয়ার্ড নং-০৯</option>
            </select>

            <select id="genderSelect">
                <option value="male">পুরুষ</option>
                <option value="female">মহিলা</option>
            </select>
        </div>
        
        <input id="searchInput" placeholder="নাম, জন্ম তারিখ অথবা ভোটার নং লিখুন..." autocomplete="off">
        <button id="searchBtn">অনুসন্ধান করুন</button>
        
        <button id="downloadBtn">ফলাফল সেভ করুন (.txt)</button>
        <div id="errorBox"></div>
    </div>

    <div id="results"></div>
    <div id="count" class="count"></div>
</div>

<footer>
    <div class="footer-content">
        <h3>Bhai Bhai Scan Pro v2.0</h3>
        <p>Created by Md. Rayhan</p>
        <div class="contact-links">
            <a href="mailto:bhaibhai1494@gmail.com">Email Developer</a>
            <a href="https://wa.me/qr/M6MQ5PRJECBDD1">WhatsApp Support</a>
        </div>
        <p style="margin-top: 20px; font-size: 0.7rem; opacity: 0.5;">© 2024 All Rights Reserved.</p>
    </div>
</footer>

<script>
const pdfjsLib = window['pdfjs-dist/build/pdf'];
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

const e2b = {"0":"০","1":"১","2":"২","3":"৩","4":"৪","5":"৫","6":"৬","7":"৭","8":"৮","9":"৯"};
const b2e = {"০":"0","১":"1","২":"2","৩":"3","৪":"4","৫":"5","৬":"6","৭":"7","৮":"8","৯":"9"};
const toBn = s => s.replace(/[0-9]/g, d => e2b[d]);
const toEn = s => s.replace(/[০-৯]/g, d => b2e[d]);

const fixMap = {
    "িক":"কি","িখ":"খি","িগ":"গি","িঘ":"ঘি","িচ":"চি","িছ":"ছি","িজ":"জি","িট":"টি","িঠ":"ঠি","িড":"ডি","িণ":"ণি","িত":"তি","িথ":"থি","িদ":"দি","িন":"নি","িপ":"পি","িফ":"ফি","িব":"বি","িভ":"ভি","িম":"মি","ির":"রি","িল":"লি","িশ":"শি","িষ":"ষি","িস":"সি","িহ":"হি","িড়":"ড়ি","িয়":"য়ি",
    "েক":"কে","েখ":"খে","েগ":"গে","েত":"তে","েন":"নে","েপ":"পে","েব":"বে","েম":"মে","ের":"রে","েল":"লে","েশ":"শে","েস":"সে",
    "োক":"কো","োগ":"গো","োচ":"চো","োত":"তো","োদ":"দো","োন":"নো","োপ":"পো","োব":"বো","োম":"মো","োর":"রো","োল":"লো","ৌশ":"শৌ",
    "Ïমাঃ":"মোঃ","Ïবগম":"বেগম","Ïভাটার নং":"ভোটার নং","আ×ার":"আক্তার","জĥ তািরখ":"জন্ম তারিখ","ę":"দ","Ɓ":"রু","Ň":"ম্ম","ছাĔ/ছাĔ":"ছাত্র/ছাত্রী","আ×ার": "আক্তার","িপতা":"পিতা","িঠকানা":"ঠিকানা","জĥ তািরখ":"জন্ম তারিখ","চর ফËাশন": "চর ফ্যাশন","Ï":"ি","চর ফ্যাশন,": "চর ফ্যাশন, ভোলা।",
    "Řিমক": "শ্রমিক", "বËবসা": "ব্যবসা", "Ïবসরকারী চাƣরী": "বেসরকারী চাকুরী","ভলোা।": "ভোলা।","s": "নু","Ůলু": "স্কুল","Ů": "স্ক"," িবিব": "বিবি", "বািড়": "বাড়ি","ঠকিানা": "ঠিকানা","ƀফয়িা": "সুফিয়া","ƀ": "সু","ƃ": "দু","হিাসেন": "হোসেন",
    "ĥ": "ম", "Ë": "্য", "Ř": "শ", "ē": "ত", "ę": "দ", " িপশা:": "পেশা:", "Ïবসরকারী চাƣরী": "বেসরকারী চাকুরী","মিýল": "মঞ্জিল",
    " িবসরকারী চাƣরী": "বেসরকারী চাকুরী", "পাটÎ": "পার্ট", " িরাড": "রোড", "Ō": "ল্ল", "Ƅ": "শু", "Ñ": "ক্ক", "উতর": "উত্তর",
    "Ï": "ে", " েভালা": " ", " েপশা:": "পেশা:", "ė": "দ্দি",
    "েকা": "কো", "েখা": "খো", "েগা": "গো", "েঘা": "ঘো", "েচা": "চো", "েছা": "ছো", "েজা": "জো", "েঝা": "ঝো",
    "েটা": "টো", "েঠা": "ঠো", "েডা": "ডো", "েঢা": "ঢো", "েণা": "ণো", "েতা": "তো", "েথা": "থো", "েদা": "দো",
    "েধা": "ধো", "েনা": "নো", "েপা": "পো", "েফা": "ফো", "েবা": "বো", "েভা": "ভো", "েমা": "মো", "েযা": "যো",
    "েরা": "রো", "েলা": "লো", "েশা": "শো", "েষা": "ষো", "েসা": "সো", "েহা": "হো", "েড়া": "ড়ো", "েঢ়া": "ঢ়ো", "েয়া": "য়ো",
    "েক": "কে", "েখ": "খে", "েগ": "গে", "েঘ": "ঘে", "েঙ": "ঙে",
    "েচ": "চে", "েছ": "ছে", "েজ": "জে", "েঝ": "ঝে", "েঞ": "ঙে",
    "েট": "টে", "েঠ": "ঠে", "েড": "ডে", "েঢ": "ঢে", "েণ": "ণে",
    "েত": "তে", "েথ": "থে", "েদ": "দে", "েধ": "ধে", "েন": "নে",
    "েপ": "পে", "েফ": "ফে", "েব": "বে", "েভ": "ভে", "েম": "মে",
    "েয": "যে", "ের": "রে", "েল": "লে", "েশ": "শে", "েষ": "ষে",
    "েস": "সে", "েহ": "হে", "েড়": "ড়ে", "েঢ়": "ঢ়ে", "েয়": "য়ে",
    "েড়": "ড়ে", "েঢ়": "ঢ়ে",
    
    "েশ্র": "শ্রে", "েপ্র": "প্রে", "েব্র": "ব্রে", "েত্র": "ত্রে", 
    "েক্র": "ক্রে", "েগ্র": "গ্রে", "েদ্র": "দ্রে", "েধ্র": "ধ্রে",
    "েক্ল": "ক্লে", "েপ্ল": "প্লে", "েস্লা": "স্লে", 
    "েক্ট": "ক্টে", "েস্ট": "স্টে", "েন্ত": "ন্তে", "েন্ন": "ন্নে",
    "েল্ল": "ল্লে", "েশ্চ": "শ্চে", "েক্স": "ক্সে",
    "েক্ষ": "ক্ষে",
    
    "পশো:": "পেশা:", "ছাত্রীী": "ছাত্রী", "বািড়": "বাড়ি", "জম": "জন্ম",
    "ŏ": "ল্ড", "ũ": "স্ত", "Ģ": "ন্ত", "ওয়াডÎ": "ওয়ার্ড", "ƣ": "কু",
    "সদÎার": "সর্দার", " েবকার,": "বেকার,", "ĩ": "ন্স", "হোিল্ডং নং-": "হোল্ডং নং-",
    " েমহে": "মেহে", "Ŧ": "স্ক", " েব": "বে",

    "Ũা": "স্টা", "ĺু": "ব্দু", "মািঝ": "মাঝি", "êী": "ঙ্গী", "Ɔ": "হু", 
    "২০ চূড়ান্ত ভোটার তালিকা জেলা: উপজেলা: চর ফ্যাশন ইউনিয়ন: ওয়ার্ড নং-০৮ ডাকঘর: চরফ্যাশন ভোটার এলাকার কোড: ০৯১২ ভোটার এলাকার": " ",
    "নাম: উত্তর মাদাজ -৮নং ওয়ার্ড অংশ (েপৗরসভার সাবেক ৯নং ওয়ার্ড অংশ)": " ",
    
    "নাম:": "<br><span class='label-text'>নাম:</span>",
    "ভোটার নং:": "<br><span class='label-text'>ভোটার নং:</span>",
    "পিতা:": "<br><span class='label-text'>পিতা:</span>",
    "মাতা:": "<br><span class='label-text'>মাতা:</span>",
    "পেশা:": "<br><span class='label-text'>পেশা:</span>",
    "জন্ম তারিখ:": "<br><span class='label-text'>জন্ম তারিখ:</span>",
    "ঠিকানা:": "<br><span class='label-text'>ঠিকানা:</span>",
};

let records = [];

function fixBangla(t) {
    for (const k in fixMap) t = t.replaceAll(k, fixMap[k]);
    return t.replace(/[ ]{2,}/g, " ").trim();
}

async function loadPDF(path) {
    records = [];
    const s = document.getElementById("status");
    const bar = document.getElementById("bar");
    const err = document.getElementById("errorBox");
    err.innerHTML = "";
    s.textContent = "Loading Records..."; 
    bar.style.width = "10%";

    try {
        const loadingTask = pdfjsLib.getDocument(path);
        const pdf = await loadingTask.promise;
        let raw = "";
        
        for (let i = 1; i <= pdf.numPages; i++) {
            const p = await pdf.getPage(i);
            const c = await p.getTextContent();
            raw += c.items.map(x => x.str).join(" ") + " ";
            bar.style.width = (i / pdf.numPages * 100) + "%";
        }

        const splitPattern = /\s+(?=[\d০-৯]+\.)/g;
        records = raw.split(splitPattern).map(r => fixBangla(r)).filter(r => r.length > 20);
        
        s.textContent = "DATABASE READY: " + toBn(String(records.length)) + " RECORDS";
    } catch (e) {
        s.textContent = "ERROR LOADING FILE";
        err.innerHTML = `<div class="error-msg">Error: ${e.message}<br>Verify the PDF exists in the 'pdfs' folder.</div>`;
    }
}

function search() {
    const q = document.getElementById("searchInput").value.trim();
    const out = document.getElementById("results");
    const cnt = document.getElementById("count");
    const btn = document.getElementById("downloadBtn");
    
    out.innerHTML = ""; 
    cnt.textContent = "";
    btn.style.display = "none";

    if (!q || !records.length) return;

    const qBn = toBn(q);
    const qEn = toEn(q);
    let foundCount = 0;

    records.forEach(r => {
        if (r.includes(qBn) || r.includes(qEn)) {
            const highlighted = r.replaceAll(qBn, `<span class="highlight">${qBn}</span>`);
            out.innerHTML += `<div class="result-card"><div class="data-content">${highlighted}</div></div>`;
            foundCount++;
        }
    });

    if (foundCount > 0) {
        cnt.textContent = `মোট ${toBn(String(foundCount))} টি তথ্য পাওয়া গেছে`;
        btn.style.display = "block";
    } else {
        cnt.textContent = "কোনো তথ্য খুঁজে পাওয়া যায়নি";
    }
}

function updateAndLoad() {
    const ward = document.getElementById("wardSelect").value;
    const gender = document.getElementById("genderSelect").value;
    loadPDF(`pdfs/${ward}n_${gender}.pdf`);
}

document.getElementById("downloadBtn").onclick = () => {
    const results = document.querySelectorAll(".result-card");
    let content = "Cyber-Scan Pro Results\n" + "=".repeat(20) + "\n\n";
    results.forEach((card, i) => { content += `[${i+1}] ${card.innerText}\n\n`; });
    const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `Search_Results.txt`;
    link.click();
};

document.getElementById("searchInput").oninput = e => {
    const cursor = e.target.selectionStart;
    e.target.value = toBn(e.target.value);
    e.target.setSelectionRange(cursor, cursor);
};

document.getElementById("searchBtn").onclick = () => search();
document.getElementById("searchInput").onkeydown = e => { if (e.key === "Enter") search(); };
document.getElementById("wardSelect").onchange = () => updateAndLoad();
document.getElementById("genderSelect").onchange = () => updateAndLoad();

window.onload = () => updateAndLoad();
</script>
</body>
</html>
